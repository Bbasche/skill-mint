import nacl, { SignKeyPair } from "tweetnacl";

//#region ../@core/src/types/index.d.ts

type idOSUser = {
  id: string;
  recipient_encryption_public_key: string;
};
type idOSCredential = {
  id: string;
  user_id: string;
  issuer_auth_public_key: string;
  original_id?: string;
  public_notes: string;
  content: string;
  encryptor_public_key: string;
};
type idOSWallet = {
  id: string;
  user_id: string;
  address: string;
  wallet_type: string;
  message: string;
  public_key: string;
  signature: string;
};
type idOSUserAttribute = {
  id: string;
  attribute_key: string;
  value: string;
  user_id?: string;
};
type idOSGrant = {
  id: string;
  ag_owner_user_id: string;
  ag_grantee_wallet_identifier: string;
  data_id: string;
  locked_until: string;
  content_hash?: string;
}; //#endregion
//#region ../@core/src/kwil-actions/credentials.d.ts

interface EditCredentialAsIssuerParams {
  public_notes_id: string;
  public_notes: string;
} //#endregion
//#region src/services/credential.service.d.ts

/**
* Edits the public notes of an idOSCredential if the signer is a permissioned issuer.
* This is how a credential is edited (modified) by a permissioned issuer.
*/
type BaseCredentialParams = {
  id?: string;
  userId: string;
  publicNotes: string;
  plaintextContent: Uint8Array;
  recipientEncryptionPublicKey: Uint8Array;
};
type DelegatedWriteGrantBaseParams = Omit<BaseCredentialParams, "userId">;
type DelegatedWriteGrantParams = {
  id: string;
  ownerWalletIdentifier: string;
  consumerWalletIdentifier: string;
  issuerPublicKey: string;
  accessGrantTimelock: string;
  notUsableBefore: string;
  notUsableAfter: string;
  signature: string;
};

//#endregion
//#region src/services/credentials-builder.service.d.ts
interface CredentialFields {
  id: string;
  /* Level of KYC verification performed (e.g., basic, intermediate, advanced). */
  level: string;
  /* @default Date.now() */
  issued?: Date;
  /* Date the credential was approved. */
  approvedAt?: Date;
  /* Date the credential was revoked. */
  expirationDate?: Date;
}
interface CredentialResidentialAddress {
  /* Street address. */
  street: string;
  /* House number. */
  houseNumber?: string;
  /* Additional address information (e.g., apartment number). */
  additionalAddressInfo?: string;
  /* Locality (e.g., city, town). */
  city: string;
  /* Postal code. */
  postalCode: string;
  /* Country. */
  country: string;
}
interface CredentialSubject {
  /* ID(unique credential)	Unique identifier for the credential itself. */
  id: string;
  /* Given name of the individual. */
  firstName: string;
  /* Surname of the individual. */
  familyName: string;
  /* Family name at birth (e.g., maiden name). */
  maidenName?: string;
  /* Unique identifier issued by a government authority (e.g., SSN, Tax ID). */
  governmentId?: string;
  /* Type of government identifier (e.g., Social Security Number, Tax ID, etc.). */
  governmentIdType?: string;
  /* Date of birth of the individual. */
  dateOfBirth: Date;
  /* City and state/province of birth. */
  placeOfBirth: string;
  /* Country that issued the identity document. */
  idDocumentCountry: string;
  /* ID Document Number	Unique number on the identity document. */
  idDocumentNumber: string;
  /* ID Document Type	Type of identity document(e.g., Passport, Driver's License, National ID). */
  idDocumentType: string;
  /* ID Document Date of Issue	Date the identity document was issued. */
  idDocumentDateOfIssue: Date;
  /* ID Document Date of Expiry	Expiration date of the identity document - if applicable. */
  idDocumentDateOfExpiry?: Date;
  /* ID Document Front File	File or URL representing the front of the identity document. */
  idDocumentFrontFile: Buffer;
  /* ID Document Back File	File or URL representing the back of the identity document - if applicable. */
  idDocumentBackFile?: Buffer;
  /* (ID Document) Selfie File	File or URL of a selfie with the identity document for verification purposes. */
  selfieFile: Buffer;
  /* Residential Address	Full residential address of the individual - if applicable. */
  residentialAddress?: CredentialResidentialAddress;
  /* Residential Address Proof Category	Type of document provided to verify the address(e.g., utility bill, bank statement). */
  residentialAddressProofCategory?: string;
  /* Residential Address Proof Date Of Issue	Date the address proof document was issued. */
  residentialAddressProofDateOfIssue?: Date;
  /* Residential Address Proof File	File or URL of the document provided as address proof. */
  residentialAddressProofFile?: Buffer;
}
interface CredentialsIssuerConfig {
  /* Issuers id */
  id: string;
  /* Issuer of the credential (URL). */
  controller: string;
  /* Issuer's private key in multibase format. */
  privateKeyMultibase: string;
  /* Issuer's public key in multibase format. */
  publicKeyMultibase: string;
} //#endregion
//#region src/services/grant.service.d.ts
type CreateAccessGrantFromDAGParams = {
  dag_data_id: string;
  dag_owner_wallet_identifier: string;
  dag_grantee_wallet_identifier: string;
  dag_signature: string;
  dag_locked_until: number;
  dag_content_hash: string;
};

//#endregion
//#region src/services/user.service.d.ts
type CreateProfileReqParams = Omit<idOSUser, "id"> & {
  id?: string;
};
type UpsertWalletReqParams = Omit<idOSWallet, "id"> & {
  id?: string;
};
type CreateWalletReqParams = Omit<UpsertWalletReqParams, "user_id"> & {
  id?: string;
};

//#endregion
//#region src/index.d.ts
type CreateIssuerParams = {
  chainId?: string;
  nodeUrl: string;
  signingKeyPair: SignKeyPair;
  encryptionSecretKey: Uint8Array;
};
declare class idOSIssuer {
  #private;
  static init(params: CreateIssuerParams): Promise<idOSIssuer>;
  private constructor();
  // User Service facade methods
  hasProfile(userAddress: string): Promise<boolean>;
  createUserProfile(params: CreateProfileReqParams): Promise<idOSUser>;
  upsertWalletAsInserter(params: UpsertWalletReqParams): Promise<idOSWallet>;
  createUser(user: CreateProfileReqParams, wallet: CreateWalletReqParams): Promise<[idOSUser, idOSWallet]>;
  createCredentialByDelegatedWriteGrant(credentialParams: DelegatedWriteGrantBaseParams, delegatedWriteGrant: DelegatedWriteGrantParams, consumerEncryptionPublicKey?: Uint8Array): Promise<{
    originalCredential: Omit<idOSCredential, "user_id">;
    copyCredential: Omit<idOSCredential, "user_id">;
  }>;
  editCredentialAsIssuer(publicNotesId: string, publicNotes: string): Promise<EditCredentialAsIssuerParams | null>;
  getCredentialIdByContentHash(contentHash: string): Promise<string | null>;
  getSharedCredential(id: string): Promise<idOSCredential | null>;
  createAccessGrantFromDAG(params: CreateAccessGrantFromDAGParams): Promise<CreateAccessGrantFromDAGParams | null>;
  buildCredentials(fields: CredentialFields, subject: CredentialSubject, issuer: CredentialsIssuerConfig): Promise<any>;
  // biome-ignore lint/suspicious/noExplicitAny: Using `any` to avoid type errors.
  buildDocumentLoader(): any;
}

//#endregion
export { idOSCredential, idOSGrant, idOSIssuer, idOSUser, idOSUserAttribute, idOSWallet };
//# sourceMappingURL=index.d.ts.map