"use strict";
// function that separates
// *big numbers* from *small* ones
//
// (works for input parameter num of type number/string)
// null is accounted for because of the regex
Object.defineProperty(exports, "__esModule", { value: true });
exports.parseWithSafeInt = void 0;
const isBigNumber = (num) => {
    if (num === null) {
        return false;
    }
    if (typeof num === 'number') {
        return +num >= Number.MAX_SAFE_INTEGER || +num <= Number.MIN_SAFE_INTEGER;
    }
    if (typeof num === 'string') {
        return num.length > Number.MAX_SAFE_INTEGER.toString().length || num.length > Number.MIN_SAFE_INTEGER.toString().length;
    }
};
// function that checks if a number is a decimal
// (works for input parameter num of type number/string)
// null is accounted for because of the regex
const isDecimal = (num) => {
    if (num === null) {
        return false;
    }
    if (typeof num === 'number') {
        return Number.isInteger(num);
    }
    if (typeof num === 'string') {
        return num.includes('.');
    }
    return false;
};
// function that enquotes numbers that are not safe or
// are decimals in a JSON string
// this helps us clean up the JSON string before parsing
const enquoteNumsOrStrings = (jsonString) => jsonString.replaceAll(/([:\s\[,]*)(\d+(?:\.\d+)?)([\s,\]]*)/g, (matchingSubstr, prefix, bigNum, suffix) => isBigNumber(bigNum) || isDecimal(bigNum)
    ? `${prefix}"${bigNum}"${suffix}`
    : matchingSubstr);
// parser that turns matching *big numbers* in
// source JSON string to bigint
const parseWithSafeInt = (jsonString) => JSON.parse(enquoteNumsOrStrings(jsonString));
exports.parseWithSafeInt = parseWithSafeInt;
//# sourceMappingURL=bigNumber.js.map