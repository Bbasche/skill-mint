"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolveNamespace = exports.validateNamespace = void 0;
const validateNamespace = (namespace) => {
    // Validate namespace
    if (!namespace || typeof namespace !== 'string') {
        return false;
    }
    // Check for SQL injection attempts in namespace
    if (/[';{}\\]/.test(namespace)) {
        return false;
    }
    // validate alphanumeric and underscore
    if (!/^[a-zA-Z0-9_]+$/.test(namespace)) {
        return false;
    }
    return true;
};
exports.validateNamespace = validateNamespace;
const resolveNamespace = (actionBody) => {
    if (actionBody.namespace) {
        return actionBody.namespace;
    }
    if (actionBody.dbid) {
        console.warn('Warning: The "dbid" field is deprecated. Please use "namespace" instead.');
        return actionBody.dbid;
    }
    throw new Error('Either "namespace" or "dbid" must be provided');
};
exports.resolveNamespace = resolveNamespace;
//# sourceMappingURL=namespace.js.map